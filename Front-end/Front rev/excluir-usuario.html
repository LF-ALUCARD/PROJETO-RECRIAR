<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Excluir Usuário</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <!-- Cabeçalho -->
        <h1><a href="menu.html" style="color:white; text-decoration:none;">Instituto Recriar</a></h1>
    </header>

    <!-- Menu lateral -->
    <div id="menu-container"></div>
    

    <div class="container">
        <h2>Excluir Usuário</h2>
        <p>Tem certeza que deseja excluir o usuário abaixo?</p>

        <!-- Área onde serão exibidos os dados do usuário selecionado -->
        <div id="dadosUsuario" style="margin: 1rem 0; padding: 1rem; border: 1px solid #ccc; border-radius: 6px;"></div>

        <!-- Botões de ação -->
        <div style="text-align:center; margin-top:1rem;">
            <button onclick="confirmarExclusao()">Confirmar</button>
            <button onclick="cancelarExclusao()">Cancelar</button>
        </div>
    </div>

    <script src="menu.js"></script>
    <script>
    document.addEventListener("DOMContentLoaded", () => {
      // BACKEND: Carregar o menu e barra superior
      // O menu.js já faz isso, mas se precisar de dados do backend para o menu, inserir aqui.

      // Pega o ID da query string (ex: excluir-usuario.html?id=U001)
      const urlParams = new URLSearchParams(window.location.search);
      const usuarioId = urlParams.get("id");

      if (usuarioId) {
        carregarDadosUsuarioParaExclusao(usuarioId);
      } else {
        console.error("ID do usuário não fornecido na URL.");
        alert("ID do usuário não fornecido. Por favor, retorne à página de administração.");
        // BACKEND: Opcional: redirecionar para a página de listagem de usuários
        // window.location.href = 'admin.html';
      }
    });

    async function carregarDadosUsuarioParaExclusao(id) {
      // BACKEND: Substituir esta simulação pela chamada à API para buscar os dados do usuário pelo ID
      try {
        // Exemplo de como seria a chamada real (assumindo uma API REST)
        // const response = await fetch(`/api/usuarios/${id}`);
        // if (!response.ok) throw new Error('Erro ao carregar usuário');
        // const usuario = await response.json();

        // Simulação de dados
        const usuariosMock = [
          {id:"U001", nomeUsuario:"Carlos Souza", email:"carlos@email.com", perfil:"Administrador", telefone:"(27)99999-0000"}
        ];
        const usuario = usuariosMock.find(u => u.id === id);

        // Mostra dados na tela
        if(usuario){
          document.getElementById("dadosUsuario").innerHTML = `
            <p><strong>ID:</strong> ${usuario.id}</p>
            <p><strong>Nome:</strong> ${usuario.nomeUsuario}</p>
            <p><strong>E-mail:</strong> ${usuario.email}</p>
            <p><strong>Perfil:</strong> ${usuario.perfil}</p>
            <p><strong>Telefone:</strong> ${usuario.telefone}</p>
          `;
        }else{
          document.getElementById("dadosUsuario").innerHTML = "<p style=\'color:red;\'>Usuário não encontrado!</p>";
          alert("Usuário não encontrado!");
          // BACKEND: Opcional: redirecionar para a página de listagem de usuários
          // window.location.href = 'admin.html';
        }
      } catch (error) {
        console.error("Erro ao carregar dados do usuário para exclusão:", error);
        alert("Não foi possível carregar os dados do usuário.");
      }
    }

    // Funções dos botões
    async function confirmarExclusao(){
      const urlParams = new URLSearchParams(window.location.search);
      const usuarioId = urlParams.get("id");

      if (!usuarioId) {
        alert("ID do usuário não encontrado para exclusão.");
        return;
      }

      // BACKEND: Chamar API para exclusão do usuário
      try {
        // Exemplo de como seria a chamada real (assumindo uma API REST DELETE)
        // const response = await fetch(`/api/usuarios/${usuarioId}`, {
        //   method: 'DELETE'
        // });

        // if (!response.ok) throw new Error('Erro ao excluir usuário');

        alert("Usuário excluído com sucesso! (Simulado)");
        window.location.href = "admin.html"; // volta para a lista de usuários
      } catch (error) {
        console.error("Erro ao excluir usuário:", error);
        alert("Não foi possível excluir o usuário.");
      }
    }

    function cancelarExclusao(){
      window.location.href = "admin.html"; // volta para a lista de usuários sem excluir
    }
    </script>
</body>
</html>

