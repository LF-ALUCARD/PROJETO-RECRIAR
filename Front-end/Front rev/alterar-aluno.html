<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Alterar Aluno</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* Adicionado para centralizar o formulário */
    .container form {
      max-width: 600px;
      margin: 0 auto;
      padding: 20px;
      border: 1px solid #ddd;
      border-radius: 8px;
      background-color: #f9f9f9;
    }
  </style>
</head>
<body>
  <!-- Menu via JS -->
  <div id="menu-container"></div>

  <main>
    <div class="container">
      <h2>Alterar Aluno</h2>
      <form id="form-alterar-aluno">
        <label for="nomeAluno">Nome do Aluno</label>
        <input type="text" id="nomeAluno" name="nomeAluno" required>

        <label for="nascAluno">Data de Nascimento</label>
        <input type="date" id="nascAluno" name="nascAluno" required>

        <label for="docAluno">Documento de Identidade</label>
        <input type="text" id="docAluno" name="docAluno" required>

        <label for="nomeResp">Nome do Responsável</label>
        <input type="text" id="nomeResp" name="nomeResp" required>

        <label for="nascResp">Data de Nascimento do Responsável</label>
        <input type="date" id="nascResp" name="nascResp">

        <label for="docResp">Documento de Identificação do Responsável</label>
        <input type="text" id="docResp" name="docResp">

        <label for="rua">Rua</label>
        <input type="text" id="rua" name="rua">

        <label for="numero">Número</label>
        <input type="text" id="numero" name="numero">

        <label for="bairro">Bairro</label>
        <input type="text" id="bairro" name="bairro">

        <label for="cidade">Cidade</label>
        <input type="text" id="cidade" name="cidade">

        <label for="telefone">Telefone</label>
        <input type="text" id="telefone" name="telefone" required>

        <div class="form-actions">
          <button type="submit">Salvar Alterações</button>
        </div>
      </form>
    </div>
  </main>

  <script src="menu.js" defer></script>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // BACKEND: Carregar o menu e barra superior
      // O menu.js já faz isso, mas se precisar de dados do backend para o menu, inserir aqui.

      const urlParams = new URLSearchParams(window.location.search);
      const alunoId = urlParams.get("id");

      if (alunoId) {
        carregarDadosAluno(alunoId);
      } else {
        console.error("ID do aluno não fornecido na URL.");
        alert("ID do aluno não fornecido. Por favor, retorne à página de alunos.");
        // BACKEND: Opcional: redirecionar para a página de listagem de alunos
        // window.location.href = 'alunos.html';
      }

      document.getElementById("form-alterar-aluno").addEventListener("submit", function(e){
        e.preventDefault();
        salvarAlteracoesAluno(alunoId);
      });
    });

    async function carregarDadosAluno(id) {
      // BACKEND: Substituir esta simulação pela chamada à API para buscar os dados do aluno pelo ID
      try {
        // Exemplo de como seria a chamada real (assumindo uma API REST)
        // const response = await fetch(`/api/alunos/${id}`);
        // if (!response.ok) throw new Error('Erro ao carregar aluno');
        // const aluno = await response.json();

        // Dados mock para demonstração
        const alunosMock = [
          {id:"001", nomeAluno:"João Silva", nascAluno:"2010-01-01", docAluno:"123456",
           nomeResp:"Maria Silva", nascResp:"1980-05-10", docResp:"654321",
           rua:"Rua A", numero:"10", bairro:"Centro", cidade:"Serra", telefone:"(27)99999-1111"},
        ];
        const aluno = alunosMock.find(a => a.id === id);

        if(aluno){
          document.getElementById("nomeAluno").value = aluno.nomeAluno;
          document.getElementById("nascAluno").value = aluno.nascAluno;
          document.getElementById("docAluno").value = aluno.docAluno;
          document.getElementById("nomeResp").value = aluno.nomeResp;
          document.getElementById("nascResp").value = aluno.nascResp;
          document.getElementById("docResp").value = aluno.docResp;
          document.getElementById("rua").value = aluno.rua;
          document.getElementById("numero").value = aluno.numero;
          document.getElementById("bairro").value = aluno.bairro;
          document.getElementById("cidade").value = aluno.cidade;
          document.getElementById("telefone").value = aluno.telefone;
        } else {
          console.error("Aluno não encontrado.");
          alert("Aluno não encontrado.");
          // BACKEND: Opcional: redirecionar para a página de listagem de alunos
          // window.location.href = 'alunos.html';
        }
      } catch (error) {
        console.error("Erro ao carregar dados do aluno:", error);
        alert("Não foi possível carregar os dados do aluno.");
      }
    }

    async function salvarAlteracoesAluno(id) {
      const nomeAluno = document.getElementById("nomeAluno").value;
      const nascAluno = document.getElementById("nascAluno").value;
      const docAluno = document.getElementById("docAluno").value;
      const nomeResp = document.getElementById("nomeResp").value;
      const nascResp = document.getElementById("nascResp").value;
      const docResp = document.getElementById("docResp").value;
      const rua = document.getElementById("rua").value;
      const numero = document.getElementById("numero").value;
      const bairro = document.getElementById("bairro").value;
      const cidade = document.getElementById("cidade").value;
      const telefone = document.getElementById("telefone").value;

      const dadosAlunoAtualizados = {
        id: id,
        nomeAluno: nomeAluno,
        nascAluno: nascAluno,
        docAluno: docAluno,
        nomeResp: nomeResp,
        nascResp: nascResp,
        docResp: docResp,
        rua: rua,
        numero: numero,
        bairro: bairro,
        cidade: cidade,
        telefone: telefone
      };

      // BACKEND: Enviar dadosAlunoAtualizados para a API de atualização do aluno
      try {
        // Exemplo de como seria a chamada real (assumindo uma API REST PUT/PATCH)
        // const response = await fetch(`/api/alunos/${id}`, {
        //   method: 'PUT',
        //   headers: {
        //     'Content-Type': 'application/json'
        //   },
        //   body: JSON.stringify(dadosAlunoAtualizados)
        // });

        // if (!response.ok) throw new Error('Erro ao salvar alterações do aluno');

        console.log('Dados do aluno atualizados:', dadosAlunoAtualizados);
        alert('Aluno alterado com sucesso! (Simulado)');
        // BACKEND: Opcional: redirecionar para a página de listagem de alunos ou atualizar a página
        // window.location.href = 'alunos.html';

      } catch (error) {
        console.error('Erro ao salvar alterações do aluno:', error);
        alert('Não foi possível salvar as alterações do aluno.');
      }
    }
  </script>
</body>
</html>

